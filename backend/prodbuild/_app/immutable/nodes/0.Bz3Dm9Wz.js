import{d as te,f as E,a as w,s as b,b as me}from"../chunks/CwDV2ZAI.js";import{o as B,a as be}from"../chunks/oPJpDEAD.js";import{b as _e,E as xe,g as he,Q as ye,L as we,h as re,i as ke,at as Se,au as Ee,av as $e,W as ae,ar as J,ak as Ne,X as Ae,a7 as Te,Z as se,_ as d,V as k,o as s,a0 as t,$ as a,Y as P,aw as Le}from"../chunks/ZqAPZRbL.js";import{i as Q}from"../chunks/BFaBCOOW.js";import{e as ne,i as We}from"../chunks/C7JNzSMk.js";import{g as S,s as A}from"../chunks/DqRx0sPc.js";import{b as Ce}from"../chunks/BD9az56a.js";import{s as Ie,a as Fe}from"../chunks/Dmjw4m20.js";import{s as Me}from"../chunks/6td1SPc6.js";function De(e,r,...n){var g=e,u=ye,i;_e(()=>{u!==(u=r())&&(i&&(we(i),i=null),i=he(()=>u(g,...n)))},xe),re&&(g=ke)}const je=Symbol("is custom element"),Re=Symbol("is html");function Oe(e,r,n,g){var u=Pe(e);re&&(u[r]=e.getAttribute(r),e.nodeName==="LINK")||u[r]!==(u[r]=n)&&(n==null?e.removeAttribute(r):typeof n!="string"&&Ue(e).includes(r)?e[r]=n:e.setAttribute(r,n))}function Pe(e){return e.__attributes??(e.__attributes={[je]:e.nodeName.includes("-"),[Re]:e.namespaceURI===Se})}var ee=new Map;function Ue(e){var r=ee.get(e.nodeName);if(r)return r;ee.set(e.nodeName,r=[]);for(var n,g=e,u=Element.prototype;u!==g;){n=$e(g);for(var i in n)n[i].set&&r.push(i);g=Ee(g)}return r}var ze=(e,r)=>S.removeNotification(s(r).id),He=E('<div><div class="flex items-center justify-between"><div class="flex items-center space-x-3"><span class="text-xl"> </span> <div><div class="text-white font-medium text-sm"> </div> <div class="text-gray-400 text-xs mt-1"> </div></div></div> <button class="text-gray-400 hover:text-white ml-4 p-1" title="Dismiss">✕</button></div></div>'),Ke=()=>S.clearNotifications(),qe=E('<div class="fixed top-4 right-4 z-40 max-w-sm"><div class="bg-gray-700 rounded-lg p-3 text-white text-sm"><div class="flex items-center justify-between"><span> </span> <button class="text-gray-300 hover:text-white text-xs px-2 py-1 bg-gray-600 rounded">Clear All</button></div></div></div>'),Be=E('<div class="fixed top-4 right-4 z-50 max-w-sm space-y-2"></div> <!>',1);function Je(e,r){ae(r,!0);let n=J(Ne([]));B(()=>S.notifications.subscribe(v=>{k(n,v,!0)}));function g(c){setTimeout(()=>{S.removeNotification(c.id)},1e4)}function u(c){return c.toLocaleTimeString()}function i(c){switch(c){case"error":return"🚨";case"warning":return"⚠️";case"info":return"ℹ️";default:return"🔔"}}Ae(()=>{s(n).forEach(c=>{g(c)})});var f=Be(),T=Te(f);ne(T,21,()=>s(n),c=>c.id,(c,v)=>{var l=He(),_=a(l),m=a(_),x=a(m),h=a(x,!0);t(x);var y=d(x,2),N=a(y),L=a(N,!0);t(N);var W=d(N,2),M=a(W,!0);t(W),t(y),t(m);var D=d(m,2);D.__click=[ze,v],t(_),t(l),P((U,j)=>{A(l,1,`bg-gray-800 border-l-4 rounded-lg shadow-lg p-4 animate-slide-in
                   ${s(v).severity==="error"?"border-red-500":""}
                   ${s(v).severity==="warning"?"border-yellow-500":""}
                   ${s(v).severity==="info"?"border-blue-500":""}`,"svelte-1laav8v"),b(h,U),b(L,s(v).message),b(M,j)},[()=>i(s(v).severity),()=>u(s(v).timestamp)]),w(c,l)}),t(T);var $=d(T,2);{var F=c=>{var v=qe(),l=a(v),_=a(l),m=a(_),x=a(m);t(m);var h=d(m,2);h.__click=[Ke],t(_),t(l),t(v),P(()=>b(x,`${s(n).length??""} active alerts`)),w(c,v)};Q($,c=>{s(n).length>3&&c(F)})}w(e,f),se()}te(["click"]);const Qe=()=>{const e=Me;return{page:{subscribe:e.page.subscribe},navigating:{subscribe:e.navigating.subscribe},updated:e.updated}},Ve={subscribe(e){return Qe().page.subscribe(e)}};async function Xe(e,r){try{document.fullscreenElement?(await document.exitFullscreen(),k(r,!1)):(await document.documentElement.requestFullscreen(),k(r,!0))}catch(n){console.error("Error toggling fullscreen:",n)}}var Ye=()=>S.clearNotifications(),Ze=E('<div class="absolute bottom-0 left-0 right-0 h-0.5 bg-blue-400"></div>'),Ge=E('<a><span class="text-lg"> </span> <span> </span> <!></a>'),et=E('<div class="absolute top-4 right-4 z-50"><div class="bg-black bg-opacity-50 text-white px-3 py-2 rounded-lg text-sm backdrop-blur-sm">Press <kbd class="bg-gray-700 px-2 py-1 rounded text-xs">ESC</kbd> to exit fullscreen</div></div>'),tt=E('<div class="min-h-screen bg-gray-900 text-gray-200"><header><div class="flex items-center justify-between"><div class="flex items-center space-x-4"><img src="/logo.png" class="h-12" alt="Agnirath Logo"/> <h1 class="text-2xl font-bold text-white">Agnirath Telemetry Dashboard</h1> <div class="flex items-center space-x-2"><div></div> <span class="text-sm text-gray-300"> </span></div></div> <div class="flex items-center space-x-4"><div class="text-sm text-gray-400">Live Telemetry Dashboard</div> <button class="flex items-center space-x-2 px-3 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg transition-colors duration-200 text-sm" title="Clear All Notifications"><span class="text-lg">🔔</span> <span>Clear Alerts</span></button> <button class="flex items-center space-x-2 px-3 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg transition-colors duration-200 text-sm" title="Toggle Fullscreen (ESC to exit)"><span class="text-lg"> </span> <span> </span></button></div></div></header> <nav><div class="px-4"><div class="flex justify-between"></div></div></nav> <main><!> <!></main> <!></div>');function vt(e,r){ae(r,!0);const[n,g]=Ie(),u=()=>Fe(Ve,"$page",n);let i=null,f=null;const T="ws://localhost:8000/ws/updates";let $=J(!1);function F(){i&&i.readyState===WebSocket.OPEN||(i=new WebSocket(T),i.onopen=()=>{k($,!0),console.log("WebSocket connected"),f&&(clearInterval(f),f=null)},i.onmessage=o=>{try{const p=JSON.parse(o.data);p.type=="update"?S.handleWebSocketUpdate(p):p.type=="data"&&S.handleWebSocketData(p)}catch(p){console.error("Error parsing WebSocket message:",p)}},i.onclose=o=>{k($,!1),console.log("WebSocket disconnected:",o.code,o.reason),f||(f=setInterval(()=>{console.log("Attempting to reconnect..."),F()},3e3))},i.onerror=o=>{console.error("WebSocket error:",o)})}B(async()=>{F()}),be(()=>{i&&i.close(),f&&clearInterval(f)});const c=[{name:"Overview",path:"/",icon:"🏠"},{name:"Battery",path:"/battery",icon:"🔋"},{name:"Motor",path:"/motor",icon:"⚙️"},{name:"Solar",path:"/solar",icon:"☀️"},{name:"Strategy",path:"/strategy",icon:"📋"},{name:"System Status",path:"/system_status",icon:"🚨"}];function v(o){return o==="/"?u().url.pathname==="/":u().url.pathname.startsWith(o)}let l=J(!1),_;function m(o){o.key==="Escape"&&document.fullscreenElement&&(document.exitFullscreen(),k(l,!1))}function x(){k(l,!!document.fullscreenElement)}B(()=>(document.addEventListener("keydown",m),document.addEventListener("fullscreenchange",x),()=>{document.removeEventListener("keydown",m),document.removeEventListener("fullscreenchange",x)}));var h=tt();me(o=>{Le.title="Agnirath"});var y=a(h),N=a(y),L=a(N),W=d(a(L),4),M=a(W),D=d(M,2),U=a(D,!0);t(D),t(W),t(L);var j=d(L,2),V=d(a(j),2);V.__click=[Ye];var z=d(V,2);z.__click=[Xe,l];var H=a(z),oe=a(H,!0);t(H);var X=d(H,2),ie=a(X,!0);t(X),t(z),t(j),t(N),t(y);var R=d(y,2),Y=a(R),Z=a(Y);ne(Z,21,()=>c,We,(o,p)=>{var C=Ge(),K=a(C),ve=a(K,!0);t(K);var q=d(K,2),ue=a(q,!0);t(q);var pe=d(q,2);{var ge=I=>{var fe=Ze();w(I,fe)};Q(pe,I=>{v(s(p).path)&&I(ge)})}t(C),P(I=>{Oe(C,"href",s(p).path),A(C,1,`relative flex items-center justify-center space-x-2 px-6 py-4 text-sm font-medium transition-colors duration-200 hover:bg-gray-700 flex-1 ${I??""}`),b(ve,s(p).icon),b(ue,s(p).name)},[()=>v(s(p).path)?"text-blue-400 bg-gray-700":"text-gray-300 hover:text-white"]),w(o,C)}),t(Z),t(Y),t(R);var O=d(R,2),G=a(O);{var ce=o=>{var p=et();w(o,p)};Q(G,o=>{s(l)&&o(ce)})}var le=d(G,2);De(le,()=>r.children),t(O);var de=d(O,2);Je(de,{}),t(h),Ce(h,o=>_=o,()=>_),P(()=>{A(y,1,`bg-gray-800 border-b border-gray-700 p-4 ${s(l)?"hidden":"block"}`),A(M,1,`w-3 h-3 rounded-full ${s($)?"bg-green-500":"bg-red-500"}`),b(U,s($)?"Connected":"Disconnected"),b(oe,s(l)?"🪟":"⛶"),b(ie,s(l)?"Exit":"Fullscreen"),A(R,1,`bg-gray-800 border-b border-gray-700 ${s(l)?"hidden":"block"}`),A(O,1,`flex-1 ${s(l)?"min-h-screen":""}`)}),w(e,h),se(),g()}te(["click"]);export{vt as component};
