import{f,a as b,s as d}from"../chunks/CwDV2ZAI.js";import{i as He}from"../chunks/_8TqtyVi.js";import{W as Je,Y as V,Z as Ke,_ as a,$ as t,t as w,a0 as e,a1 as P,o as l}from"../chunks/ZqAPZRbL.js";import{i as fe}from"../chunks/BFaBCOOW.js";import{e as A,i as E}from"../chunks/C7JNzSMk.js";import{s as p,g as Qe}from"../chunks/DqRx0sPc.js";import{s as he}from"../chunks/CFu27dXM.js";import{s as Xe,a as et}from"../chunks/Dmjw4m20.js";var tt=f('<div class="w-px h-4 bg-gray-600"></div>'),at=f('<div class="flex items-center space-x-3"><span class="text-sm text-gray-300"> </span> <div class="flex items-center space-x-1"><span class="text-sm text-gray-400">O:</span> <div></div></div> <div class="flex items-center space-x-1"><span class="text-sm text-gray-400">E:</span> <div></div></div> <!></div>'),rt=f('<div class="flex items-center justify-center space-x-1"><div></div> <span class="text-xs text-gray-300"> </span></div>'),st=f('<div class="bg-gray-600 rounded p-3 text-center"><div class="text-xs text-gray-400 mb-1"></div> <div class="text-sm font-medium mb-2"> </div> <div class="w-full h-2 rounded-full bg-gray-500"><div></div></div></div>'),it=f('<div class="grid grid-cols-8 gap-3"></div>'),lt=f('<div class="text-center text-gray-400 py-4"></div>'),vt=f('<div class="bg-gray-700 rounded-lg p-4 border border-gray-600"><div class="flex items-center justify-between mb-3"><div class="flex items-center space-x-4"><h4 class="text-lg font-medium text-white"></h4> <div class="flex items-center space-x-4"><div class="flex items-center space-x-2"><div></div> <span class="text-sm text-gray-300"> </span></div> <div class="flex items-center space-x-2"><div></div> <span class="text-sm text-gray-300"> </span></div></div></div></div> <!></div>'),dt=f('<div class="space-y-6 p-6"><div class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-6 gap-4"><div class="metric-card col-span-1 md:col-span-2 svelte-23yu5p"><div class="metric-value text-green-400 text-3xl svelte-23yu5p"> </div> <div class="metric-label svelte-23yu5p">State of Charge</div> <div class="mt-2 bg-gray-700 rounded-full h-2"><div class="bg-green-500 h-2 rounded-full transition-all duration-300"></div></div></div> <div class="metric-card svelte-23yu5p"><div class="metric-value text-yellow-400 svelte-23yu5p"> </div> <div class="metric-label svelte-23yu5p">Pack Voltage</div></div> <div class="metric-card svelte-23yu5p"><div class="metric-value text-blue-400 svelte-23yu5p"> </div> <div class="metric-label svelte-23yu5p">Pack Current</div></div> <div class="metric-card svelte-23yu5p"><div class="metric-value text-red-400 svelte-23yu5p"> </div> <div class="metric-label svelte-23yu5p">Max Temperature</div></div> <div class="metric-card svelte-23yu5p"><div class="metric-value text-cyan-400 svelte-23yu5p"> </div> <div class="metric-label svelte-23yu5p">Min Temperature</div></div></div> <div class="grid grid-cols-1 md:grid-cols-3 gap-4"><div class="metric-card svelte-23yu5p"><div class="flex items-center justify-between"><span class="metric-label svelte-23yu5p">Voltage Range</span> <span class="text-sm text-gray-300"> </span></div></div> <div class="metric-card svelte-23yu5p"><div class="flex items-center justify-between"><span class="metric-label svelte-23yu5p">Temperature Range</span> <span class="text-sm text-gray-300"> </span></div></div> <div class="metric-card svelte-23yu5p"><div class="flex items-center justify-between"><span class="metric-label svelte-23yu5p">Pre-charge State</span> <div class="flex items-center space-x-2"><div></div> <span> </span></div></div></div></div> <div class="bg-gray-800 rounded-lg p-4 border border-gray-700"><div class="flex items-center justify-between"><div class="flex items-center justify-start flex-1 space-x-6"><span class="text-sm text-gray-400">Contactors:</span> <!></div> <div class="flex items-center space-x-2"><span class="text-sm text-gray-400">Supply:</span> <div></div></div></div></div> <div class="bg-gray-800 rounded-lg p-4 border border-gray-700"><div class="flex items-center justify-between mb-3"><span class="text-sm text-gray-400">BMS Status:</span></div> <div class="grid grid-cols-4 md:grid-cols-5 lg:grid-cols-7 gap-4"></div></div> <div class="bg-gray-800 rounded-lg p-4 border border-gray-700"><div class="mb-4"><h3 class="text-lg font-semibold">Battery Pack Details</h3></div> <div class="space-y-4"></div> <div class="mt-4 flex justify-center space-x-6 text-xs"><div class="flex items-center space-x-2"><div class="w-3 h-3 bg-green-500 rounded"></div> <span>Normal</span></div> <div class="flex items-center space-x-2"><div class="w-3 h-3 bg-yellow-500 rounded"></div> <span>Warning</span></div> <div class="flex items-center space-x-2"><div class="w-3 h-3 bg-red-500 rounded"></div> <span>Critical</span></div></div></div></div>');function xt(Ce,$e){Je($e,!1);const[we,ke]=Xe(),i=()=>et(Qe,"$globalStore",we);function c(r,s="",v=2){return typeof r!="number"?"N/A":`${r.toFixed(v)} ${s}`}function Se(r){return typeof r!="number"?"bg-gray-600":r>4.2||r<2.5?"bg-red-500":r>2.5&&r<2.8?"bg-yellow-500":"bg-green-500"}function K(r){return typeof r!="number"?"bg-gray-600":r>45?"bg-red-500":r>35?"bg-yellow-500":"bg-green-500"}function Ve(r){return typeof r!="number"?0:Math.min(100,Math.max(0,(r-2.5)/(4.2-2.5)*100))}function O(r){const s=[{name:"Error",color:"bg-red-500",textColor:"text-red-400"},{name:"Idle",color:"bg-gray-500",textColor:"text-gray-400"},{name:"Measure",color:"bg-blue-500",textColor:"text-blue-400"},{name:"Pre-charge",color:"bg-yellow-500",textColor:"text-yellow-400"},{name:"Run",color:"bg-green-500",textColor:"text-green-400"},{name:"Enable Pack",color:"bg-cyan-500",textColor:"text-cyan-400"}];return s[r]||s[0]}const Pe=[{key:"cell_over_voltage",label:"CellOverVolt"},{key:"cell_under_voltage",label:"CellUnderVolt"},{key:"cell_over_temp",label:"CellOverTemp"},{key:"measurement_untrusted",label:"MeasErr"},{key:"measurement_untrusted",label:"CMU_TO"},{key:"vehicle_comm_timeout",label:"Veh_TO"},{key:"bms_setup_mode",label:"Setup"},{key:"cmu_can_status",label:"CAN_Status",color:"bg-green-400"},{key:"isolation_test_fail",label:"IsolationFail"},{key:"soc_invalid",label:"SoC_Invalid"},{key:"can_supply_low",label:"CAN_Low"},{key:"contactor_not_engaged",label:"Cont_NE"},{key:"extra_cell_detected",label:"Extra_Cell"}];He();var T=dt(),U=t(T),F=t(U),I=t(F),Me=t(I,!0);e(I);var Q=a(I,4),je=t(Q);he(je,"width: 80%"),e(Q),e(F);var N=a(F,2),X=t(N),Ae=t(X,!0);e(X),P(2),e(N);var R=a(N,2),ee=t(R),Ee=t(ee,!0);e(ee),P(2),e(R);var W=a(R,2),te=t(W),Oe=t(te,!0);e(te),P(2),e(W);var ae=a(W,2),re=t(ae),Te=t(re,!0);e(re),P(2),e(ae),e(U);var B=a(U,2),L=t(B),se=t(L),ie=a(t(se),2),Ue=t(ie);e(ie),e(se),e(L);var q=a(L,2),le=t(q),ve=a(t(le),2),Fe=t(ve);e(ve),e(le),e(q);var de=a(q,2),ce=t(de),ne=a(t(ce),2),oe=t(ne),D=a(oe,2),Ie=t(D,!0);e(D),e(ne),e(ce),e(de),e(B);var Y=a(B,2),_e=t(Y),Z=t(_e),Ne=a(t(Z),2);A(Ne,0,()=>[1,2,3],E,(r,s)=>{var v=at();const _=w(()=>i().metric.contactor_flags[`contactor${s}_error`]),o=w(()=>i().metric.contactor_flags[`contactor${s}_output`]);var n=t(v),m=t(n);e(n);var g=a(n,2),h=a(t(g),2);e(g);var u=a(g,2),C=a(t(u),2);e(u);var k=a(u,2);{var M=$=>{var j=tt();b($,j)};fe(k,$=>{s<3&&$(M)})}e(v),V(()=>{d(m,`C${s??""}`),p(h,1,`w-3 h-3 rounded-full ${l(o)?"bg-green-500":"bg-gray-500"}`),p(C,1,`w-3 h-3 rounded-full ${l(_)?"bg-red-500":"bg-green-500"}`)}),b(r,v)}),e(Z);var pe=a(Z,2),Re=a(t(pe),2);e(pe),e(_e),e(Y);var z=a(Y,2),me=a(t(z),2);A(me,5,()=>Pe,E,(r,s)=>{var v=rt();const _=w(()=>i().metric.bmsFlags[l(s).key]);var o=t(v),n=a(o,2),m=t(n,!0);e(n),e(v),V(()=>{p(o,1,`w-3 h-3 rounded-full ${l(_)?`${l(s).color||"bg-red-500"}`:"bg-gray-500"} flex-shrink-0`,"svelte-23yu5p"),d(m,l(s).label)}),b(r,v)}),e(me),e(z);var ge=a(z,2),ue=a(t(ge),2);A(ue,5,()=>i().metric.cmus,E,(r,s,v)=>{var _=vt(),o=t(_),n=t(o),m=t(n);m.textContent=`CMU ${v+1}`;var g=a(m,2),h=t(g),u=t(h),C=a(u,2),k=t(C);e(C),e(h);var M=a(h,2),$=t(M),j=a($,2),We=t(j);e(j),e(M),e(g),e(n),e(o);var Be=a(o,2);{var Le=x=>{var y=it();A(y,5,()=>l(s).cell_voltages,E,(G,S,De)=>{var H=st(),xe=t(H);xe.textContent=`Cell ${De}`;var J=a(xe,2),Ye=t(J,!0);e(J);var ye=a(J,2),be=t(ye);e(ye),e(H),V((Ze,ze,Ge)=>{d(Ye,Ze),p(be,1,`h-2 rounded-full ${ze??""}`,"svelte-23yu5p"),he(be,`width: ${Ge??""}%`)},[()=>c(l(S),"V",3),()=>Se(l(S)),()=>Ve(l(S))],w),b(G,H)}),e(y),b(x,y)},qe=x=>{var y=lt();y.textContent=`No cell data available for Pack ${v+1}`,b(x,y)};fe(Be,x=>{l(s).cell_voltages&&l(s).cell_voltages.length>0?x(Le):x(qe,!1)})}e(_),V((x,y,G,S)=>{p(u,1,`w-3 h-3 rounded-full ${x??""}`,"svelte-23yu5p"),d(k,`CMU: ${y??""}`),p($,1,`w-3 h-3 rounded-full ${G??""}`,"svelte-23yu5p"),d(We,`Cell: ${S??""}`)},[()=>K(l(s).temperature),()=>c(l(s).temperature,"°C",1),()=>K(l(s).cell_temperature),()=>c(l(s).cell_temperature,"°C",1)],w),b(r,_)}),e(ue),P(2),e(ge),e(T),V((r,s,v,_,o,n,m,g,h,u,C,k)=>{d(Me,r),d(Ae,s),d(Ee,v),d(Oe,_),d(Te,o),d(Ue,`${n??""} - ${m??""}`),d(Fe,`${g??""} - ${h??""}`),p(oe,1,`w-3 h-3 rounded-full ${u??""}`,"svelte-23yu5p"),p(D,1,`text-sm ${C??""}`,"svelte-23yu5p"),d(Ie,k),p(Re,1,`w-3 h-3 rounded-full ${i().metric.contactor_flags.contactor_supply?"bg-green-500":"bg-red-500"}`)},[()=>c(i().metric.SOC_Ah,"Ah",0),()=>c(i().metric.Pack_Voltage,"V"),()=>c(i().metric.Pack_Current,"A"),()=>c(i().metric.battery_ranges.max_temp,"°C"),()=>c(i().metric.battery_ranges.min_temp,"°C"),()=>c(i().metric.battery_ranges.min_volt,"V"),()=>c(i().metric.battery_ranges.max_volt,"V"),()=>c(i().metric.battery_ranges.min_temp,"°C"),()=>c(i().metric.battery_ranges.max_temp,"°C"),()=>O(i().metric.precharge_state).color,()=>O(i().metric.precharge_state).textColor,()=>O(i().metric.precharge_state).name],w),b(Ce,T),Ke(),ke()}export{xt as component};
