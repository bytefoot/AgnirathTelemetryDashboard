import{f as K,a as Y,s as l}from"../chunks/CwDV2ZAI.js";import{i as et}from"../chunks/_8TqtyVi.js";import{o as tt,a as rt}from"../chunks/oPJpDEAD.js";import{W as at,a3 as z,a4 as it,Y as G,Z as st,_ as a,$ as r,t as J,o as s,B as g,V as f,a0 as t,a1 as d}from"../chunks/ZqAPZRbL.js";import{e as ye,i as he}from"../chunks/C7JNzSMk.js";import{g as lt,s as Ce}from"../chunks/DqRx0sPc.js";import{b as B}from"../chunks/BD9az56a.js";import{s as ot,a as vt}from"../chunks/Dmjw4m20.js";import{C as y,a as dt,L as ct,P as _t,b as mt,c as nt,p as ut,d as pt,e as bt}from"../chunks/BU_mMZHm.js";var gt=K('<div class="flex items-center justify-center space-x-1"><div></div> <span class="text-xs text-gray-300"> </span></div>'),ft=K('<div class="flex items-center justify-center space-x-1"><div></div> <span class="text-xs text-gray-300"> </span></div>'),xt=K('<div class="space-y-6 p-6"><div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"><div class="metric-card svelte-1wa4b97"><div class="metric-value text-green-400 text-2xl svelte-1wa4b97"> </div> <div class="metric-label svelte-1wa4b97">Motor RPM</div></div> <div class="metric-card svelte-1wa4b97"><div class="metric-value text-blue-400 text-2xl svelte-1wa4b97"> </div> <div class="metric-label svelte-1wa4b97">Velocity</div></div> <div class="metric-card svelte-1wa4b97"><div class="metric-value text-orange-400 text-2xl svelte-1wa4b97"> </div> <div class="metric-label svelte-1wa4b97">Motor Temperature</div></div> <div class="metric-card svelte-1wa4b97"><div class="metric-value text-cyan-400 text-2xl svelte-1wa4b97"> </div> <div class="metric-label svelte-1wa4b97">Heatsink Temperature</div></div></div> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-4"><div class="metric-card svelte-1wa4b97"><div class="metric-value text-purple-400 svelte-1wa4b97"> </div> <div class="metric-label svelte-1wa4b97">Phase Current A</div></div> <div class="metric-card svelte-1wa4b97"><div class="metric-value text-purple-400 svelte-1wa4b97"> </div> <div class="metric-label svelte-1wa4b97">Phase Current B</div></div> <div class="metric-card svelte-1wa4b97"><div class="metric-value text-purple-400 svelte-1wa4b97"> </div> <div class="metric-label svelte-1wa4b97">Phase Current C</div></div> <div class="metric-card svelte-1wa4b97"><div class="metric-value text-yellow-400 svelte-1wa4b97"> </div> <div class="metric-label svelte-1wa4b97">Bus Voltage</div></div> <div class="metric-card svelte-1wa4b97"><div class="metric-value text-red-400 svelte-1wa4b97"> </div> <div class="metric-label svelte-1wa4b97">Bus Current</div></div> <div class="metric-card svelte-1wa4b97"><div class="metric-value text-orange-400 svelte-1wa4b97"> </div> <div class="metric-label svelte-1wa4b97">Bus Power</div></div></div> <div class="bg-gray-800 rounded-lg p-4 border border-gray-700"><div class="flex items-center justify-between mb-3"><span class="text-sm text-gray-400">Motor Limit Status:</span></div> <div class="grid grid-cols-3 md:grid-cols-4 lg:grid-cols-7 gap-4"></div></div> <div class="bg-gray-800 rounded-lg p-4 border border-gray-700"><div class="flex items-center justify-between mb-3"><span class="text-sm text-gray-400">Motor Error Status:</span></div> <div class="grid grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4"></div></div> <div class="plot-container svelte-1wa4b97"><canvas class="w-full h-80"></canvas></div> <div class="grid grid-cols-1 xl:grid-cols-2 gap-6"><div class="plot-container svelte-1wa4b97"><canvas class="w-full h-80"></canvas></div> <div class="plot-container svelte-1wa4b97"><canvas class="w-full h-80"></canvas></div></div> <div class="plot-container svelte-1wa4b97"><canvas class="w-full h-80"></canvas></div> <div class="bg-gray-800 rounded-lg p-4 border border-gray-700"><h3 class="text-lg font-semibold mb-4">Motor Efficiency Analysis</h3> <div class="grid grid-cols-1 md:grid-cols-3 gap-4"><div class="text-center"><div class="text-2xl font-bold text-blue-400"> </div> <div class="text-sm text-gray-400">Distance per Revolution</div></div> <div class="text-center"><div class="text-2xl font-bold text-green-400"> </div> <div class="text-sm text-gray-400">Power per Speed</div></div> <div class="text-center"><div class="text-2xl font-bold text-purple-400"> </div> <div class="text-sm text-gray-400">Average Phase Current</div></div></div></div></div>');function St(Me,Pe){at(Pe,!1);const[ke,Be]=ot(),e=()=>vt(lt,"$globalStore",ke),Q=g(),X=g();let h=g(),C=g(),M=g(),P=g(),_,x,m,n;function v(i,c="",o=1){return typeof i!="number"?"N/A":`${i.toFixed(o)} ${c}`}function k(i,c,o,u){return{type:"line",data:{labels:e().historic.Timestamps,datasets:[{label:i,data:c,borderColor:o,backgroundColor:o+"20",borderWidth:2,fill:!1,tension:.1}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:i==="Battery Level",max:i==="Battery Level"?100:void 0,title:{display:!0,text:u,color:"#fff"},ticks:{color:"#fff"},grid:{color:"#374151"}},x:{title:{display:!0,text:"Time",color:"#fff"},ticks:{color:"#fff"},grid:{color:"#374151"}}},plugins:{legend:{labels:{color:"#fff"}},title:{display:!0,text:`${i} vs Time`,color:"#fff"}}}}}function Ae(){e().historic.Timestamps.length!==0&&(_&&(_.data.labels=e().historic.Timestamps,_.data.datasets[0].data=e().historic.Bus_Power,_.update("none")),x&&(x.data.labels=e().historic.Timestamps,x.data.datasets[0].data=e().historic.PhaseA_Current,x.update("none")),m&&(m.data.labels=e().historic.Timestamps,m.data.datasets[0].data=e().historic.Motor_Velocity,m.update("none")),n&&(n.data.labels=e().historic.Timestamps,n.data.datasets[0].data=e().historic.Speed2,n.update("none")))}tt(()=>{y.register(dt,ct,_t,mt,nt,ut,pt,bt),s(h)&&(_=new y(s(h),k("Bus Power",e().historic.Bus_Power,"#f59e0b","Bus Power (W)"))),s(C)&&(x=new y(s(C),k("Phase A Current",e().historic.PhaseA_Current,"#ab47bc","Bus Power (W)"))),s(M)&&(m=new y(s(M),k("Motor RPM",e().historic.Motor_Velocity,"#10b981","Motor RPM vs Time"))),s(P)&&(n=new y(s(P),k("Vehicle Speed (km/h)",e().historic.Speed2,"#3b82f6","Vehicle Speed vs Time")))}),rt(()=>{_&&_.destroy(),m&&m.destroy(),n&&n.destroy()});const Se=[{key:"ipm_temp_limit",label:"IPM Temp"},{key:"bus_voltage_lower_limit",label:"Bus V Low"},{key:"bus_voltage_upper_limit",label:"Bus V High"},{key:"bus_current_limit",label:"Bus Current"},{key:"velocity_limit",label:"Velocity"},{key:"motor_current_limit",label:"Motor Current"},{key:"output_voltage_pwm_limit",label:"Output PWM"}],Le=[{key:"motor_over_speed",label:"Over Speed"},{key:"desaturation_fault",label:"Desaturation"},{key:"rail_15v_uvlo",label:"15V UVLO"},{key:"config_read_error",label:"Config Error"},{key:"watchdog_reset",label:"Watchdog"},{key:"bad_motor_position",label:"Hall Sequence"},{key:"dc_bus_over_voltage",label:"DC Bus OV"},{key:"software_over_current",label:"SW OC"},{key:"hardware_over_current",label:"HW OC"}];z(()=>e(),()=>{e().historic.Timestamps.length>0&&Ae()}),z(()=>e(),()=>{f(Q,{ipm_temp_limit:e().metric.MotorLimits.ipm_temp_limit,bus_voltage_lower_limit:e().metric.MotorLimits.bus_voltage_lower_limit,bus_voltage_upper_limit:e().metric.MotorLimits.bus_voltage_upper_limit,bus_current_limit:e().metric.MotorLimits.bus_current_limit,velocity_limit:e().metric.MotorLimits.velocity_limit,motor_current_limit:e().metric.MotorLimits.motor_current_limit,output_voltage_pwm_limit:e().metric.MotorLimits.output_voltage_pwm_limit})}),z(()=>e(),()=>{f(X,{motor_over_speed:e().metric.MotorErrors.motor_over_speed,desaturation_fault:e().metric.MotorErrors.desaturation_fault,rail_15v_uvlo:e().metric.MotorErrors.rail_15v_uvlo,config_read_error:e().metric.MotorErrors.config_read_error,watchdog_reset:e().metric.MotorErrors.watchdog_reset,bad_motor_position:e().metric.MotorErrors.bad_motor_position,dc_bus_over_voltage:e().metric.MotorErrors.dc_bus_over_voltage,software_over_current:e().metric.MotorErrors.software_over_current,hardware_over_current:e().metric.MotorErrors.hardware_over_current})}),it(),et();var A=xt(),S=r(A),L=r(S),ee=r(L),Ve=r(ee,!0);t(ee),d(2),t(L);var V=a(L,2),te=r(V),Te=r(te,!0);t(te),d(2),t(V);var T=a(V,2),re=r(T),Ee=r(re,!0);t(re),d(2),t(T);var ae=a(T,2),ie=r(ae),$e=r(ie,!0);t(ie),d(2),t(ae),t(S);var E=a(S,2),$=r(E),se=r($),We=r(se,!0);t(se),d(2),t($);var W=a($,2),le=r(W),Oe=r(le,!0);t(le),d(2),t(W);var O=a(W,2),oe=r(O),Re=r(oe,!0);t(oe),d(2),t(O);var R=a(O,2),ve=r(R),He=r(ve,!0);t(ve),d(2),t(R);var H=a(R,2),de=r(H),je=r(de,!0);t(de),d(2),t(H);var ce=a(H,2),_e=r(ce),De=r(_e,!0);t(_e),d(2),t(ce),t(E);var j=a(E,2),me=a(r(j),2);ye(me,5,()=>Se,he,(i,c)=>{var o=gt();const u=J(()=>s(Q)[s(c).key]);var p=r(o),b=a(p,2),w=r(b,!0);t(b),t(o),G(()=>{Ce(p,1,`w-3 h-3 rounded-full ${s(u)?"bg-yellow-500":"bg-gray-500"} flex-shrink-0`),l(w,s(c).label)}),Y(i,o)}),t(me),t(j);var D=a(j,2),ne=a(r(D),2);ye(ne,5,()=>Le,he,(i,c)=>{var o=ft();const u=J(()=>s(X)[s(c).key]);var p=r(o),b=a(p,2),w=r(b,!0);t(b),t(o),G(()=>{Ce(p,1,`w-3 h-3 rounded-full ${s(u)?"bg-red-500":"bg-gray-500"} flex-shrink-0`),l(w,s(c).label)}),Y(i,o)}),t(ne),t(D);var F=a(D,2),Fe=r(F);B(Fe,i=>f(h,i),()=>s(h)),t(F);var q=a(F,2),Z=r(q),qe=r(Z);B(qe,i=>f(C,i),()=>s(C)),t(Z);var ue=a(Z,2),Ze=r(ue);B(Ze,i=>f(M,i),()=>s(M)),t(ue),t(q);var I=a(q,2),Ie=r(I);B(Ie,i=>f(P,i),()=>s(P)),t(I);var pe=a(I,2),be=a(r(pe),2),N=r(be),ge=r(N),Ne=r(ge,!0);t(ge),d(2),t(N);var U=a(N,2),fe=r(U),Ue=r(fe,!0);t(fe),d(2),t(U);var xe=a(U,2),we=r(xe),Ye=r(we,!0);t(we),d(2),t(xe),t(be),t(pe),t(A),G((i,c,o,u,p,b,w,ze,Ge,Je,Ke,Qe,Xe)=>{l(Ve,i),l(Te,c),l(Ee,o),l($e,u),l(We,p),l(Oe,b),l(Re,w),l(He,ze),l(je,Ge),l(De,Je),l(Ne,Ke),l(Ue,Qe),l(Ye,Xe)},[()=>v(e().metric.Motor_Velocity,"RPM",0),()=>v(e().metric.Speed2,"km/h"),()=>v(e().metric.Motor_Temp,"°C"),()=>v(e().metric.HeatSink_Temp,"°C"),()=>v(e().metric.PhaseA_Current,"A"),()=>v(e().metric.PhaseB_Current,"A"),()=>v(e().metric.PhaseC_Current,"A"),()=>v(e().metric.Bus_Voltage,"V"),()=>v(e().metric.Bus_Current,"A"),()=>v(e().metric.Bus_Power,"W",0),()=>v((e().metric.Speed2||0)/(e().metric.Motor_Velocity||1)*60,"m/rev",3),()=>v((e().metric.Bus_Power||0)/(e().metric.Speed2||1),"W⋅h/km",1),()=>v(((e().metric.PhaseB_Current||0)+(e().metric.PhaseC_Current||0))/2,"A",2)],J),Y(Me,A),st(),Be()}export{St as component};
